{"version":3,"sources":["Attributes.js"],"names":[],"mappings":"AAAA,a;;AAEa,kB,WAAA,kB;AACX,c,GAAa,E;AACb,e,GAAc,K;AACd,S,GAAQ,C;;AAEJ,a,EAAW,I,EAAM,K,EAAO;AAC1B,WAAK,WAAL,GAAmB,IAAnB;;AAEA,WAAK,MAAL,CAAY,SAAZ,EAAuB,IAAvB;AACA,WAAK,UAAL,CAAgB,IAAhB,CAAqB,EAAC,oBAAD,EAAY,UAAZ,EAAkB,YAAlB,EAArB;;AAEA,WAAK,WAAL,GAAmB,KAAnB;AACA,WAAK,cAAL,GACD,C;;;AAEM,a,EAAW,I,EAAM;AACtB,UAAM,QAAQ,KAAK,UAAL,CAAgB,SAAhB,CAA0B,4BAAU,SAAS,SAAT,KAAuB,SAAvB,IAAoC,SAAS,IAAT,KAAkB,IAAhE,EAA1B,CAAd;AACA,UAAI,QAAQ,CAAZ,EAAe;;AAEf,WAAK,UAAL,CAAgB,MAAhB,CAAuB,KAAvB,EAA8B,CAA9B;AACA,WAAK,cAAL,GACD,C;;;AAEgB;AACf,UAAI,KAAK,WAAT,EAAsB;AACtB,WAAK,KAAL,GAAa,KAAK,UAAL,CAAgB,MAAhB,CAAuB,UAAC,KAAD,EAAQ,QAAR,UAAoB,QAAQ,SAAS,KAArC,EAAvB,EAAmE,CAAnE,CAAb,CACD,C;;;;AAGU,S,WAAA,S;;;;;;;;AAQX,qBAAY,IAAZ,EAAkB,KAAlB,EAAyB,GAAzB,EAA8B,uCAP9B,KAO8B,GAPtB,CAOsB,MAN9B,MAM8B,GANrB,CAMqB,MAL9B,SAK8B,GALlB,IAAI,kBAAJ,EAKkB,MAH9B,OAG8B,GAHpB,CAGoB,MAF9B,IAE8B,GAFvB,IAEuB;AAC5B,SAAK,IAAL,GAAY,IAAZ;AACA,SAAK,KAAL,GAAa,KAAb;AACA,SAAK,QAAL,GAAgB,GAAhB,CACD,C;;;AAEU;AACT,aAAO,KAAK,KAAZ,CACD,C;;;AAEQ,S,EAAO;AACd,WAAK,KAAL,GAAa,KAAK,GAAL,CAAS,KAAT,EAAgB,KAAK,OAAL,IAAgB,KAAhC,CAAb,CACD,C;;;AAEa;AACZ,aAAO,KAAK,KAAL,GAAa,KAAK,SAAL,CAAe,KAAnC,CACD,C;;;;;AAIkB,U;AACnB,wBAA6B,KAAjB,UAAiB,yDAAJ,EAAI;AAC3B,QAAM,OAAO,OAAO,IAAP,CAAY,UAAZ,CAAb;AACA,SAAK,IAAI,IAAI,CAAR,EAAW,gBAAgB,KAAK,CAAL,CAAhC,EAAyC,IAAI,KAAK,MAAlD,EAA0D,KAAK,gBAAgB,KAAK,CAAL,CAA/E;AACE,WAAK,GAAL,CAAS,aAAT,EAAwB,WAAW,aAAX,CAAxB,EADF,CAED,C;;;AAEG,iB,EAAe,K,EAAO;AACxB,UAAI,EAAE,iBAAiB,IAAnB,CAAJ;AACE,WAAK,aAAL,IAAsB,IAAI,SAAJ,CAAc,aAAd,EAA6B,KAA7B,CAAtB,CACH,C,6CAVkB,U","file":"Attributes.js","sourcesContent":["'use strict';\r\n\r\nexport class AttributeModifiers {\r\n  _modifiers = [];\r\n  _isUpdating = false;\r\n  total = 0;\r\n\r\n  add(component, name, value) {\r\n    this._isUpdating = true;\r\n\r\n    this.remove(component, name);\r\n    this._modifiers.push({component, name, value});\r\n\r\n    this._isUpdating = false;\r\n    this.calculateTotal();\r\n  }\r\n\r\n  remove(component, name) {\r\n    const index = this._modifiers.findIndex(modifier=>modifier.component === component && modifier.name === name);\r\n    if (index < 0) return;\r\n\r\n    this._modifiers.splice(index, 1);\r\n    this.calculateTotal();\r\n  }\r\n\r\n  calculateTotal() {\r\n    if (this._isUpdating) return;\r\n    this.total = this._modifiers.reduce((total, modifier)=> total + modifier.value, 0);\r\n  }\r\n}\r\n\r\nexport class Attribute {\r\n  _base = 0;\r\n  _bonus = 0;\r\n  modifiers = new AttributeModifiers();\r\n\r\n  baseMax = 0;\r\n  name = null;\r\n\r\n  constructor(name, value, max) {\r\n    this.name = name;\r\n    this._base = value;\r\n    this._baseMax = max;\r\n  }\r\n\r\n  get base() {\r\n    return this._base;\r\n  }\r\n\r\n  set base(value) {\r\n    this._base = Math.min(value, this.baseMax || value);\r\n  }\r\n\r\n  get current() {\r\n    return this._base + this.modifiers.total;\r\n  }\r\n\r\n}\r\n\r\nexport default class Attributes {\r\n  constructor(attributes = {}) {\r\n    const keys = Object.keys(attributes);\r\n    for (let i = 0, attributeName = keys[i]; i < keys.length; i++, attributeName = keys[i])\r\n      this.add(attributeName, attributes[attributeName]);\r\n  }\r\n\r\n  add(attributeName, value) {\r\n    if (!(attributeName in this))\r\n      this[attributeName] = new Attribute(attributeName, value);\r\n  }\r\n\r\n}\r\n\r\n\r\n"],"sourceRoot":"/source/"}